#ifndef SCMA_H
#define SCMA_H

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <complex.h>
#include <time.h>



#define V 6       // number of users (layers)
#define M 4       // number of codewords in each codebook
#define K 4       // number of orthogonal resources
#define N 1       // number of SCMA signals in frame
#define maxNumErrs 100
#define maxNumBits 1e7
#define Niter 1
#define SNR_length 1



const double SNR[] = {4.771212547196624, 5.771212547196624, 6.771212547196624, 7.771212547196624, 8.771212547196624, 9.771212547196624, 10.771212547196624, 11.771212547196624, 12.771212547196624, 13.771212547196624, 14.771212547196624, 15.771212547196624, 16.771212547196626, 17.771212547196626, 18.771212547196626, 19.771212547196626, 20.771212547196626, 21.771212547196626, 22.771212547196626, 23.771212547196626, 24.771212547196626};
// Codebooks
const double CB_real[][K][M] = {
    {
        {0.0, 0.0, 0.0, 0.0},
        {-0.1815, -0.6351, 0.6351, 0.1815},
        {0.0, 0.0, 0.0, 0.0},
        {0.7851, -0.2243, 0.2243, -0.7851}
    },
    {
        {0.7851, -0.2243, 0.2243, -0.7851},
        {0.0, 0.0, 0.0, 0.0},
        {-0.1815, -0.6351, 0.6351, 0.1815},
        {0.0, 0.0, 0.0, 0.0}
    },
    {
        {-0.6351, 0.1815, -0.1815, 0.6351},
        {0.1392, 0.4873, -0.4873, -0.1392},
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0}
    },
    {
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0},
        {0.7851, -0.2243, 0.2243, -0.7851},
        {-0.0055, -0.0193, 0.0193, 0.0055}
    },
    {
        {-0.0055, -0.0193, 0.0193, 0.0055},
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0},
        {-0.6351, 0.1815, -0.1815, 0.6351}
    },
    {
        {0.0, 0.0, 0.0, 0.0},
        {0.7851, -0.2243, 0.2243, -0.7851},
        {0.1392, 0.4873, -0.4873, -0.1392},
        {0.0, 0.0, 0.0, 0.0}
    }
};

const double CB_imag[][K][M] = {
    {
        {0.0, 0.0, 0.0, 0.0},
        {-0.1318, -0.4615, 0.4615, 0.1318},
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0}
    },
    {
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0},
        {-0.1318, -0.4615, 0.4615, 0.1318},
        {0.0, 0.0, 0.0, 0.0}
    },
    {
        {0.4615, -0.1318, 0.1318, -0.4615},
        {-0.1759, -0.6156, 0.6156, 0.1759},
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0}
    },
    {
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0},
        {-0.2242, -0.7848, 0.7848, 0.2242}
    },
    {
        {-0.2242, -0.7848, 0.7848, 0.2242},
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0},
        {0.4615, -0.1318, 0.1318, -0.4615}
    },
    {
        {0.0, 0.0, 0.0, 0.0},
        {0.0, 0.0, 0.0, 0.0},
        {-0.1759, -0.6156, 0.6156, 0.1759},
        {0.0, 0.0, 0.0, 0.0}
    }
};

// int x[][N] = {{3,1,1,0,0,1,2,2,3,3},
//                     {1,1,0,0,3,3,1,0,2,3},
//                     {0,3,0,3,1,3,1,2,1,0},
//                     {2,0,2,0,3,1,1,2,2,0},
//                     {0,0,1,3,0,3,1,2,2,0},
//                     {1,2,0,1,0,1,3,0,1,1}};
                
// const double h_real[][V][N] = {
//                                 {
//                                 {0.6929, 0.1349, -0.7682, 0.8363, -0.5106, -0.3017, -0.4103, 0.2189, -0.1328, -0.2772},
//                                 {-0.1262, -0.1856, 0.2331, 0.3992, 0.3491, -0.3916, -0.4581, -0.1514, -1.1384, -0.3172},
//                                 {-0.9544, 0.5919, 0.4089, 0.7545, 0.3249, 0.1155, -0.8618, 0.5903, -1.3662, -0.0937},
//                                 {0.9856, 0.2153, -1.0018, 0.1433, -0.0342, 0.6789, 0.2552, -0.1308, -0.4353, -0.3232},
//                                 {0.5622, 0.0198, 0.6570, -1.6749, 0.6267, 1.7287, -0.5640, 2.6421, -1.1705, 0.2663},
//                                 {-0.6774, -0.1531, -0.3704, -1.0951, 0.0317, 0.2758, 0.4805, -1.0860, -0.5047, -0.3300}
//                                 },
//                                 {
//                                 {-0.0727, -0.9435, -0.5388, 0.2508, 0.4662, -0.4790, 0.7975, -0.0911, 1.6341, 0.6555},
//                                 {-0.0356, 0.6313, 0.8615, -1.3570, -0.3345, -0.4427, 0.4371, -0.2694, -0.7616, -0.5683},
//                                 {0.6543, -0.4064, 1.6089, 1.0058, 1.4100, 0.2821, -1.0776, -0.5082, 1.3010, -0.6970},
//                                 {0.5534, 0.1543, 0.6204, 0.0037, 0.9436, 0.3798, 1.1018, -1.0334, 0.7972, -0.3624},
//                                 {-0.7660, 0.6429, 0.2920, 0.2294, -0.1038, -2.0520, 0.2539, -0.3001, -0.6064, -1.6570},
//                                 {-0.0254, 0.5471, 0.2085, -0.4166, -0.2866, -1.3129, -1.0350, 0.2187, 0.5259, 0.1499}
//                                 },
//                                 {
//                                 {-1.5386, 0.4870, 1.7638, 0.5740, -0.3029, 1.0482, 0.2131, 0.8840, 0.5796, -1.8656},
//                                 {0.5523, -0.2046, 0.9316, -0.1399, 0.8832, 1.7596, -0.6554, -0.4313, 0.1578, -0.9805},
//                                 {0.1835, -1.3140, 0.0782, -0.4644, -0.4072, 0.7063, 0.7286, -0.2581, -0.8034, 0.1446},
//                                 {0.4302, -0.5583, -0.9581, -0.6552, 0.1785, 0.1720, -0.4176, 0.9445, -0.6808, -0.2307},
//                                 {-0.7629, -0.6189, -1.5304, 0.3296, 0.6829, -0.1094, -0.5306, 1.2795, -0.0504, 0.3685},
//                                 {-0.3341, 0.3435, -1.2591, 0.2588, 0.0472, -1.0837, 0.4933, 0.3408, 0.3871, 0.8629}
//                                 },
//                                 {
//                                 {-0.5955, -0.8301, -1.1666, 0.2032, -0.5170, -0.1314, 0.7959, -0.9932, -0.2064, 0.7222},
//                                 {0.0348, -0.3076, 0.2672, 0.6645, -0.1103, 0.7166, 0.0966, 0.9276, -0.3667, 0.5135},
//                                 {-1.3634, 1.2359, -0.4353, -0.0933, 0.2489, -1.0965, -0.4442, 0.1196, -0.5132, 0.4852},
//                                 {-0.3466, 0.4434, -1.0653, 0.0528, 0.4842, -0.1844, -0.1151, 0.0749, 0.0086, 0.0632},
//                                 {-1.1322, 0.1649, -0.2026, -0.3176, 0.9459, 0.6888, 0.0915, 0.9485, -1.3688, 1.1902},
//                                 {1.0638, 0.1198, 0.2986, -0.1687, -0.8380, -0.4839, 0.5006, -1.3785, -0.5757, 0.7772}
//                                 }
//                             };

// const double h_imag[][V][N] = {
//                                 {
//                                 {-0.3771, -0.5075, 1.1974, -0.1133, 0.1196, -0.9959, 0.2123, 1.2195, 1.0644, 0.3740},
//                                 {0.8898, -0.5350, 0.9344, -0.4793, -0.7945, -0.8265, -0.6925, -0.0754, 0.4958, 0.6520},
//                                 {-0.1504, 0.3886, 0.3059, 0.8575, -0.5180, 0.7755, -0.4933, 0.5043, -0.2741, -0.3692},
//                                 {-0.8667, 0.1192, 0.1140, -0.9116, -0.5964, -0.4886, 1.1219, -0.7531, 0.3574, -0.4362},
//                                 {1.8258, 0.0322, 0.3715, 0.0925, -0.3669, 0.0501, -0.3388, -1.3138, 0.2892, 0.9602},
//                                 {0.3458, 0.3681, 0.4318, -0.1215, -0.9381, -0.1444, -0.6725, 0.1437, 0.0926, 0.4687}
//                                 },
//                                 {
//                                 {0.1331, 0.8045, 0.0878, -0.0524, 0.2833, 0.9577, -0.2026, -0.1318, 0.0948, -0.1130},
//                                 {-1.0428, -0.5493, -1.0837, 0.9253, -0.1217, 0.2816, -0.7798, -1.0491, 0.3517, -0.4949},
//                                 {-0.8635, 0.7263, -0.6892, 0.3359, -0.3242, -0.2999, 0.1630, -0.1570, 0.8190, -1.5089},
//                                 {0.3058, -0.7447, 0.4878, 0.3969, 0.5298, 0.3137, -0.7857, 0.5839, -0.6380, 0.1294},
//                                 {1.2680, -0.5071, 0.1480, 1.3686, 0.6332, 0.2073, -0.2106, 1.0479, -0.5309, -0.5087},
//                                 {-0.8633, -0.3801, 1.0954, 0.4622, 0.3402, -0.1575, 0.1571, 0.1267, -1.5302, 0.0028}
//                                 },
//                                 {
//                                 {-0.4884, -0.4493, -0.4679, -0.5862, 0.8272, 1.9400, 0.5805, -0.4915, 0.9025, 0.7221},
//                                 {-1.0937, 1.1817, -0.5286, -0.9921, -1.1360, 0.5763, -0.2779, 0.8347, 0.0940, 1.6278},
//                                 {1.2384, -0.8608, 0.6560, -0.0467, 0.5543, 0.6960, 0.8136, -1.8746, -0.2323, 0.0253},
//                                 {-0.4202, 1.1895, 0.5146, -1.6879, -0.3186, -0.1844, -0.8171, 0.2459, 0.6811, -0.0028},
//                                 {-0.9414, 0.2889, 0.7132, -1.0470, -0.7371, -0.1369, -0.2361, 0.3398, 0.7882, -0.1457},
//                                 {0.3176, -0.1210, -0.5524, 0.9225, 0.4996, -0.1640, 0.8394, -0.1643, -0.8583, -0.6463}
//                                 },
//                                 {
//                                 {0.9771, -0.1161, 0.7108, -0.6180, -0.5967, 0.5031, 0.8776, -0.9990, -0.4566, 0.6838},
//                                 {0.1142, -1.1688, -0.0787, 0.5972, -0.2798, 0.1334, 0.4183, 0.9102, 1.2101, 0.4368},
//                                 {-0.7498, 0.6070, -0.3826, -0.3713, -1.2364, -0.2279, -0.5637, -0.3505, -0.6743, -0.9908},
//                                 {1.1932, 1.6540, -0.6067, 0.1965, 0.2720, -0.7257, 0.1054, -0.0125, 0.8045, 0.3378},
//                                 {0.1290, -0.1878, -0.4967, -0.4512, 0.0969, 0.8993, -0.5145, -0.4034, -0.0876, 0.3604},
//                                 {-0.6238, -0.1558, -0.1933, -0.5159, -1.7741, -0.7467, 0.5496, 1.2358, 0.8196, 0.5504}
//                                 }
//                             };


int x[][N] =   {{3},
                {3},
                {3},
                {2},
                {0},
                {0}};

const double h_real[][V][N] = {
    {
        {0.0628}, {0.8016}, {-0.1685}, {-0.3315}, {-0.0989}, {-0.0154}
    },
    {
        {-0.2385}, {-0.6921}, {0.0735}, {-0.2409}, {-0.4879}, {-0.1923}
    },
    {
        {-0.1240}, {-0.3983}, {1.3918}, {0.7742}, {-0.1785}, {-0.8052}
    },
    {
        {0.1167}, {1.4393}, {0.5903}, {0.6233}, {-0.8779}, {-0.1381}
    }
};

const double h_imag[][V][N] = {
    {
        {0.0949}, {-0.2916}, {0.0315}, {-0.8466}, {0.1234}, {-0.7915}
    },
    {
        {-1.4132}, {-1.1163}, {0.0752}, {0.2041}, {-1.1713}, {-0.2178}
    },
    {
        {-0.6843}, {-0.0409}, {0.4434}, {0.0522}, {-0.4253}, {0.0537}
    },
    {
        {-0.4424}, {-0.9037}, {-0.4352}, {-0.2834}, {-0.5441}, {0.9228}
    }
};

#endif 
